<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- 页面的样式 -->
    <link rel="stylesheet" type="text/css" href="/public/css/museum/index.css">
    <!-- 通用的样式 -->
    <script type="text/javascript" src="/public/js/jquery.min.js"></script>
    <script type="text/javascript" src="/public/js/general.js"></script>
    <link rel="stylesheet" type="text/css" href="/public/css/general.css">

    <title>museum</title>
</head>

<script>
    $(function () {
        function initCardItem() {
            let itemMax = 6;
            $('.widthBoard').css('width', $('.widthBoard').css('height') * itemMax);
            for (let i = 1; i <= itemMax; i++) {
                let itemStr = `<div id="itemBoard` + i + `" class="itemBoard" draggable="true" ondragstart="drag(event)">
                    <div class="item" >
                        <img draggable="false" src="/public/img/card/card`+ i + `.png">
                    </div>
                </div>`;
                $('.widthBoard').append(itemStr);
            }
        }

        initCardItem();


        addConBtn('默认案例', () => {
            $("#museum").show();
            $("#testArea").hide();
        });

        addConBtn('失败案例', () => {
            $("#museum").hide();
            $("#testArea").show();
            openTheFaild();
        });


        // 曲线救国
        $(".itemBoard").click(function () {
            console.log($(this).attr('id'), $(this).parent().attr('class'))

            if ($(this).parent().attr('class') == 'basket') {
                $(".widthBoard").prepend($(this));
                $(this).parent().remove(".itemBoard");
            }
        })


        // 打开失败案例
        function openTheFaild() {
            let i = 1;
            setInterval(() => {
                $("#bodyUse").attr('src', "/public/img/museum/body/body" + i + ".png")
                i++;
                if (i >= 35) {
                    i = 1;
                }
            }, 1000)
        }

    })



    // 拽动
    function drag(ev) {
        ev.dataTransfer.setData("itemId", ev.target.id);
    }

    // 经过可放区域时
    function allowDrop(ev, id) {
        // 如果内里没有元素的话允许放
        if (document.getElementById(id).childNodes.length < 1) {
            ev.preventDefault();
        }
    }

    // 放下
    function drop(ev, id) {
        var data = ev.dataTransfer.getData("itemId");
        ev.target.appendChild(document.getElementById(data));
        ev.preventDefault();
    }

</script>

<body>
    <div id="museum">
        <div id="allItemsBoard" class="ItemArea">
            <div id="allItemsWidthBoard" class="widthBoard">
            </div>
        </div>

        <div id="basketBoard" class="ItemArea gDiv">
            <div id="basket1" class="basket" ondrop="drop(event,this.id)" ondragover="allowDrop(event,this.id)"></div>
            <div id="basket2" class="basket" ondrop="drop(event,this.id)" ondragover="allowDrop(event,this.id)"></div>
            <div id="basket3" class="basket" ondrop="drop(event,this.id)" ondragover="allowDrop(event,this.id)"></div>
        </div>
    </div>
    </div>


    <!-- ------------------------------------------------------- -->


    <div id="testArea" class="gDiv">
        <p>这是一个失败的案例，失败在对图片的要求蛮多！</p>
        <div id="bodyArea" class="gDiv">
            <img id="bodyUse" src="/public/img/museum/body/body5.png">
        </div>

        <div id="headArea" class="gDiv">
            <img src="/public/img/museum/face/face.png">
        </div>

        <div id="hairArea" class="gDiv">
            <img src="/public/img/museum/hair/hair1.png">
        </div>
    </div>

</body>

</html>